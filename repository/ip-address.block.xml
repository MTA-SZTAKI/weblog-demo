<?xml version="1.0" encoding="UTF-8"?>
<block-package xmlns="urn:hu.sztaki.ilab.longneck:1.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">

  <!--
    Blocks for reverse dns.
  -->

  <!--
    Return reserved domain name and expiration.

    IN: ipaddress
    OUT: domainName, lookupExpiry
  -->
  <block id="ip-address.reverse-dns">
    <input-constraints summary="Check ipaddress">
      <entity-ref id="ip-address:ip-address.check"/>
    </input-constraints>
    <!-- Reverse DNS lookup -->
    <dnsresolve connection-name="dnsCache" />
    <!--Remove timezone information-->
    <datetime-to-format apply-to="lookupExpiry" from="lookupExpiry" from-pattern="yyyy-MM-dd HH:mm:ss Z" to-pattern="yyyy-MM-dd HH:mm:ss"/>
  </block>
</block-package>
